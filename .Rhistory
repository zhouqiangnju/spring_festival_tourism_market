temp2=tempurl[grep(pattern2,tempurl)]
urladdr=regexec(pattern,temp2)
m <- regexpr('http://(.*).jpg',temp2)
url=regmatches(temp2,m)
#写入文件
write.table(url,file="url.txt",append = TRUE)
Sys.sleep(10)
}
library(bitops)
#载入RCrul
library(RCurl)
#修改clientheader
myheader=c("User-Agent"="Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36",
"Accept"="*/*",
"Accept-Language"="zh-CN,zh;q=0.8",
"Connection"="keep-alive"
)
#调试使用，老师给的那个headher好像不能使用
#"Referer"="http://jandan.net/ooxx/page-1197"
urllist=0
page=1:7
urllist[page]=paste("http://jandan.net/ooxx/page-119",page,sep='')
for(url in urllist){
#获取妹子图
temp=getURL(url,httpheader=myheader)
k = strsplit(temp,"\r\n")[[1]]
#正则
pattern='
<img src="(.*)" />
'
pattern2='jpg" />'
tempurl=k[grep(pattern,k)]
temp2=tempurl[grep(pattern2,tempurl)]
urladdr=regexec(pattern,temp2)
m <- regexpr('http://(.*).jpg',temp2)
url=regmatches(temp2,m)
#写入文件
write.table(url,file="url.txt",append = TRUE)
Sys.sleep(10)
}
url <- 'http://www.uisdc.com/22-stunning-free-photos-websites'
picture<- read_html(url)%>% html_nodes("div.entry-content")%>%html_nodes("img")%>%html_attr("src")
head(picture,10)
{
download(picture[i],paste("F:/数据可视化/Image/picture",i,".jpg",sep = ""), mode = "wb")
}
url <- 'http://www.uisdc.com/22-stunning-free-photos-websites'
picture<- read_html(url)%>% html_nodes("div.entry-content")%>%html_nodes("img")%>%html_attr("src")
head(picture,10)
for(i in 1:length(picture))
{
download.file(picture[i],paste("F:/数据可视化/Image/picture",i,".jpg",sep = ""), mode = "wb")
}
library(rvest)
library(downloader)
library(dplyr)
url <- 'http://www.uisdc.com/22-stunning-free-photos-websites'
picture<- read_html(url)%>% html_nodes("div.entry-content")%>%html_nodes("img")%>%html_attr("src")
head(picture,10)
for(i in 1:length(picture))
{
download.file(picture[i],paste("F:/数据可视化/Image/picture",i,".jpg",sep = ""), mode = "wb")
}
help(downloader)
library(rvest)
library(downloader)
library(dplyr)
url <- 'http://www.uisdc.com/22-stunning-free-photos-websites'
picture<- read_html(url)%>% html_nodes("div.entry-content")%>%html_nodes("img")%>%html_attr("src")
head(picture,10)
for(i in 1:length(picture))
{
download.file(picture[i],paste("G:\pic\download",i,".jpg",sep = ""), mode = "wb")
}
library(rvest)
library(downloader)
library(dplyr)
url <- 'http://www.uisdc.com/22-stunning-free-photos-websites'
picture<- read_html(url)%>% html_nodes("div.entry-content")%>%html_nodes("img")%>%html_attr("src")
head(picture,10)
for(i in 1:length(picture))
{
download.file(picture[i],paste("G:/pic/download",i,".jpg",sep = ""), mode = "wb")
}
library(rvest)
library(downloader)
library(dplyr)
url <- 'http://www.uisdc.com/22-stunning-free-photos-websites'
picture<- read_html(url)%>% html_nodes("div.entry-content")%>%html_nodes("img")%>%html_attr("src")
head(picture,10)
for(i in 1:length(picture))
{
download.file(picture[i],paste("G:/pic/download/down",i,".jpg",sep = ""), mode = "wb")
}
url <- 'http://www.uutu.me/index.php?c=Article&id=2406&p=4'
picture<- read_html(url)%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")
for(i in 1:length(picture))
head(picture,10)
library(rvest)
library(downloader)
library(dplyr)
url <- 'http://www.uutu.me/index.php?c=Article&id=2406&p=4'
picture<- read_html(url)%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")
head(picture,10)
for(i in 1:length(picture))
{
download.file(picture[i],paste("G:/pic/download/down",i,".jpg",sep = ""), mode = "wb")
}
{url[i]<- 'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
data.entry(url)
url[1]
url[2]
library(rvest)
library(downloader)
library(dplyr)
for(i in 1:51)
{url[i]<- 'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
library(rvest)
library(downloader)
library(dplyr)
for(i in 1:51)
{url[i]<- 'http://www.uutu.me/index.php?c=Article&id=2406&p=i'
picture[i]<- read_html(url)%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")}
class(picture)
picture[i]<- read_html(url[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")}
for(i in 1:51)
{url[i]<- 'http://www.uutu.me/index.php?c=Article&id=2406&p=i'
picture[i]<- read_html(url[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")}
library(rvest)
library(downloader)
library(dplyr)
for(i in 1:51)
{url[i]<- 'http://www.uutu.me/index.php?c=Article&id=2406&p=i'
picture[i]<- read_html(url[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")
download.file(picture[i,1],paste("G:/pic/download/down",i,".jpg",sep = ""), mode = "wb")
}
download.file(picture[i],paste("G:/pic/download/down",i,".jpg",sep = ""), mode = "wb")
library(rvest)
library(downloader)
library(dplyr)
for(i in 1:51)
{url[i]<- 'http://www.uutu.me/index.php?c=Article&id=2406&p=i'
picture[i]<- read_html(url[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")
download.file(picture[i],paste("G:/pic/download/down",i,".jpg",sep = ""), mode = "wb")
}
View(url)
View(url)
View(url)
{url[i]<- 'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
library(rvest)
library(downloader)
library(dplyr)
for(i in 1:51)
{url[i]<- 'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
for(i in 1:51)
{gurl[i]<- 'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
library(rvest)
library(downloader)
library(dplyr)
for(i in 1:51)
{gurl[i]<-'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
class(gurl)
for(i in 1:51)
{url[i]<-'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
class(url)
{url<-'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
url
{url[i]<-'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
for(i in 1:51)
{url[i]<-'http://www.uutu.me/index.php?c=Article&id=2406&p=i'}
url
{url[i]<-'http://www.uutu.me/index.php?c=Article&id=2406&p=[i]'}
library(rvest)
library(downloader)
library(dplyr)
url<-'http://www.uutu.me/index.php?c=Article&id=2406&p=1'
picture<- read_html(url)%>% html_nodes("img.img-responsive")%>%html_nodes("img")%>%html_attr("src")
head(picture,10)
library(xml2)
library(rvest)
library(downloader)
library(dplyr)
library(xml2)
url<-'http://www.uutu.me/index.php?c=Article&id=2406&p=1'
picture<- read_html(url)%>% html_nodes("img.img-responsive")%>%html_nodes("img")%>%html_attr("src")
head(picture,10)
library(rvest)
library(downloader)
library(dplyr)
for(i in 1:51)
{url[i]<-'http://www.uutu.me/index.php?c=Article&id=2406&p=[i]'}
url
url[2]
{url[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2406&p=",[i],sep=""}
url[2]
picture[i]<- read_html(url[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")
download.file(picture[i],paste("G:/pic/download/down",i,".jpg",sep = ""), mode = "wb")
}
library(rvest)
library(downloader)
library(dplyr)
for(i in 1:51)
{url[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2406&p=",[i],sep=""}
for(i in 1:51)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2406&p=",[i],sep=""}
lianjie<-paste("a",1:51,sep="")
lianjie
for(i in 1:51)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2406&p=",[i],sep=""}
for(i in 1:51)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2406&p=",i,sep=""}
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2406&p=",i,sep="")}
lianjie<-paste("a",1:51,sep="")
for(i in 1:51)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2406&p=",i,sep="")}
library(rvest)
library(downloader)
library(dplyr)
lianjie<-paste("a",1:51,sep="")
for(i in 1:51)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2406&p=",i,sep="")
picture[i]<- read_html(lianjie[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")
download.file(picture[i],paste("G:/pic/download/down/TQE",i,".jpg",sep = ""), mode = "wb")
}
library(rvest)
library(downloader)
library(dplyr)
lianjie<-paste("a",1:51,sep="")
for(i in 1:51)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2406&p=",i,sep="")
read_html(lianjie[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")%>%download.file(paste("G:/pic/download/TQE",i,".jpg",sep = ""), mode = "wb")
}
library(rvest)
library(downloader)
library(dplyr)
lianjie<-paste("a",1:40,sep="")
for(i in 1:40)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2892&p=",i,sep="")
read_html(lianjie[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")%>%download.file(paste("G:/pic/download/XH",i,".jpg",sep = ""), mode = "wb")
}
library(rvest)
library(downloader)
library(dplyr)
lianjie<-paste("a",1:40,sep="")
for(i in 1:40)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=2424&p=",i,sep="")
read_html(lianjie[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")%>%download.file(paste("G:/pic/download/LF",i,".jpg",sep = ""), mode = "wb")
}
library(rvest)
library(downloader)
library(dplyr)
lianjie<-paste("a",1:43,sep="")
for(i in 1:43)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=1188&p=",i,sep="")
read_html(lianjie[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")%>%download.file(paste("G:/pic/download/YCC",i,".jpg",sep = ""), mode = "wb")
}
library(rvest)
library(downloader)
library(dplyr)
lianjie<-paste("a",1:46,sep="")
for(i in 1:46)
{lianjie[i]<-paste("http://www.uutu.me/index.php?c=Article&id=1379&p=",i,sep="")
read_html(lianjie[i])%>% html_nodes("div.panel-body")%>%html_nodes("img")%>%html_attr("src")%>%download.file(paste("G:/pic/download/XM/XM",i,".jpg",sep = ""), mode = "wb")
}
library(plyr)
library(maptools)
library(ggplot2)
library(plyr)
install.packages("maptools")
library(maptools)
library(ggplot2)
library(plyr)
gpclibPermit()
library(sp)
library(maptools)
library(ggplot2)
library(plyr)
library(sp)
Jiangsu_map<-readShapePoly("C:/Users/Administrator/Documents/R/Map/JIANGSU/江苏.shp")
qplot(Jiangsu_map)
plot(Jiangsu_map)
Shengyulvyou<-readShapePoly("C:/Users/Administrator/Documents/R/Map/JIANGSU/省域旅游.shp")
plot(Shengyulvyou)
x<-Jiangsu_map@data
x<-Jiangsu_map@data
?@
library(ggmap)
install.packages(ggmap)
install.packages("ggmap")
string(Jiangsu_map)
str(Jiangsu_map)
as.character(na.omit(unique(x$NAME)))
attributes(Jiangsu_map@data$NAME_0)
ggplot(Jiangsu_map,aes(x=long,y=lat,group=group))+
geom_polygon(fill＝"beige")+
geom_path(colour="grey40")
ggplot(Jiangsu_map,aes(x=long,y=lat,group=group))+
geom_polygon(fill＝"red")+
geom_path(colour="grey40")
ggplot(Jiangsu_map,aes(x=long,y=lat,group=group))+
geom_polygon()+
geom_path(colour="grey40")
ggplot(Jiangsu_map,aes(x=long,y=lat,group=group))+
geom_polygon(lty=2)+
geom_path(colour="grey40")
ggplot(Jiangsu_map,aes(x=long,y=lat,group=group))+
geom_polygon(lty=6)+
geom_path(colour="grey40")
library(ggplot2)
library(ggplot2)
library(sf)
library(shiny)
library(dplyr)
runApp('R/shiny/reactive/reactive')
runApp('R/shiny/reactive/reactive',display.mode = "showcase")
runApp('R/shiny/reactive/reactive')
runApp('R/shiny/reactive/reactive')
runApp('R/shiny/reactive/reactive')
runApp('R/shiny/reactive/reactive')
runApp('R/shiny/reactive/reactive')
runApp('R/shiny/reactive/reactive')
runApp('R/shiny/reactive/reactive')
library("XML")
library(xml2)
library("stringr")
library("RCurl")
library("dplyr")
library("rvest")
library(sf)
library(ggplot2)
library(jsonlite)
library(httr)
library(rlist)
library(leaflet)
library(RColorBrewer)
setwd('F:/Administrator/Documents/GitHub/spring_festival_tourism_market')
#prepare data
spri.data <- read.csv('spring_data.csv',stringsAsFactors = FALSE)[,-1]
#input mapfile
china.map<-st_read('F:/Administrator/Documents/R/Map/china.geojson',stringsAsFactors = FALSE)
capital<-st_read('省会.shp')
#merge files,sdm stands for spring-data-map
sdm <- merge(spri.data,china.map,by.x = 'province',by.y = 'name',all = TRUE) %>%
st_sf(stringsAsFactors = FALSE,crs = 4326,sf_column_name = 'geometry')
sdm$income <-as.numeric(sdm$income)
# visiualization
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ))+
coord_sf()
total.income
# visiualization
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),labels(province))+
coord_sf()
# visiualization
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),labels=province)+
coord_sf()
library(ggthemes)
Encoding(sdm$province)
Encoding(sdm$province)<-'UTF8'
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ))+
coord_sf()
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ))+
coord_sf()+
geom_+text(data=sdm,aes(label = province),size=3)
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ))+
coord_sf()+
geom_text(data=sdm,aes(label = province),size=3)
total.income
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = T)+
coord_sf()
total.income
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm)+
scale_fill_gradient(name=income,low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "black", breaks = pretty_breaks(n = 5))
?scale_fill_gradient
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm)+
scale_fill_gradient(name=income,low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "black", breaks = 5)
# visiualization
pal <-
total.income <- ggplot(data=sdm)+
geom_sf()+
scale_fill_gradient(name=income,low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "black", breaks = 5)
# visiualization
pal <-
total.income <- ggplot(data=sdm)+
geom_sf()+
scale_fill_gradient(name=sdm$income,low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "black", breaks = 5)
geom_text(data=sdm,aes(label = province),size=3)
total.income
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = T)
total.income
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = T)+
scale_fill_gradient(low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "black", breaks = 5)
total.income
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = T)+
scale_fill_gradient(low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "grey", breaks = 5)
total.income
?ggthemes
# visiualization
pal <-
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = T)+
scale_fill_gradient(low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "grey", breaks = 5)+
theme_economist()
total.income
# visiualization
pal <-
theme_clean <- function(base_size=12){
require(grid)
theme_grey(base_size)
theme(
axis.title = element_blank(),
axis.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.ticks.length = unit(0, "cm"),
plot.margin = unit(c(0,0,0,0), "lines"),
complete = TRUE
)
}
total.income+ theme_clean()
# visiualization
pal <-
theme_clean <- function(base_size=12){
require(grid)
theme_grey(base_size)
theme(
axis.title = element_blank(),
axis.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
complete = TRUE
)
}
total.income+ theme_clean()
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = T)+
scale_fill_gradient(low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "grey", breaks = 5)
total.income+ theme_clean()
# visiualization
pal <-
theme_clean <- function(base_size=12){
require(grid)
theme(
axis.title = element_blank(),
axis.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
)
}
total.income+ theme_clean()
total.income+ theme_clean()+theme_economist()
total.income+theme_economist()+theme_clean()
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = T)+
scale_fill_gradient(low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "grey")
total.income+theme_economist()+theme_clean()
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ))+
scale_fill_gradient(low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "grey")
total.income+theme_economist()+theme_clean()
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = F)+
scale_fill_gradient(low = "#FAB8D2", high = "#F91C74",
guide = "colorbar", na.value = "grey")
total.income+theme_economist()+theme_clean()
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = T)+
geom_text(data=sdm,aes(label = province),size=3)
total.income+theme_wsj() + scale_colour_wsj("colors6", "")+theme_clean()
total.income <- ggplot()+
geom_sf(data = sdm,aes(fill = income ),show.legend = T)
total.income+theme_wsj() + scale_colour_wsj("colors6", "")+theme_clean()
